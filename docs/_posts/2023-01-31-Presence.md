---
layout: post
title:  "Presense detecion and counting ACAP"
date: 2023-01-31 00:00:00 +0200
categories: [ACAP]
---
Detects how many people are within the cameras scene and fires event on presence and count transition. Targets non-critial use cases for low limit crowds like
* Automation
* Queue monitoring
* Dwell-time

## [Download](https://files.juhlin.me/acap/precense?source=pages)

# Features
* Easy configuration with visual validation
* Filter detection area
* Adjust event timining depending on use-case

# Intgration
Two events are fired:
1. A counter value fires on count transition changes (a person leavs or enters)
2. Presence true/false if there are anybody present.

## MQTT 
Use the Camera MQTT client and setup a publish on event "Precence counter" or "Precense detection".  
\
You can also use [SIMQTT](https://pandosme.github.io/acap/mqtt/component/2021/10/18/simqtt.html) that automaitically publish events.
Topic
```
simqtt/acap/presence/counter
```
Payload
```
{
  "name": "If defined in SIMQTT",
  "location": "If defined in SIMQTT",
  "device": "ACCCxxxxxxxx",
  "timestamp": 1676099193751,
  "value": 1,
  "event": "acap/presence/counter"
}
```
Topic
```
simqtt/acap/presence/detection/[true/false]
```
Payload
```
{
  "name": "If defined in SIMQTT",
  "location": "If defined in SIMQTT",
  "device": "ACCCxxxxxxxx",
  "timestamp": 1676099193751,
  "state": true,
  "event": "acap/presence/detection"
}
```

# Things to consider
* Axis camera needs to support AOA (Axis Object Analytics)
* Detection quality depends on scene, camera placement and light conditions
